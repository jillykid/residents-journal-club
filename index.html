<script>
  const scriptURL = 'https://script.google.com/macros/s/AKfycbwc2NQL5Kd1Zx5F-Rd8k4VGunhBWGg-WrykQqjtY8nVr9Zkby-U3tUwk7iTfEN9Nmr7ng/exec';

  async function fetchSheetData(sheetName) {
    try {
      const res = await fetch(`${scriptURL}?sheet=${encodeURIComponent(sheetName)}`);
      const data = await res.json();
      return data;
    } catch (error) {
      console.error('Fetch failed:', error);
      return [];
    }
  }

  function renderArticles(data) {
    const container = document.getElementById('articles-content');
    container.innerHTML = data.map(row => `
      <div class="entry">
        <strong>${row.Date}:</strong> <a href="${row['Link to Article']}" target="_blank">${row['Article Title']}</a>
        by ${row['Presenter Name']} [<a href="${row['Link to Presentation']}" target="_blank">Presentation</a>]
      </div>`).join('');
  }

  function renderSchedule(data) {
    const container = document.getElementById('schedule-content');
    container.innerHTML = data.map(row => `
      <div class="entry">
        <strong>${row.Date}</strong>: ${row['Presenter Name']} â€” ${row['Topic/Title']} (${row.Confirmed})
      </div>`).join('');
  }

  function renderThisWeek(data) {
    const container = document.getElementById('this-week-content');
    container.innerHTML = data.map(row => `
      <div class="entry">
        <strong>${row.Date}:</strong> [${row.Type}] <a href="${row.Link}" target="_blank">${row.Title}</a>
        <br />${row.Summary}
      </div>`).join('');
  }

  (async function init() {
    renderArticles(await fetchSheetData('Articles and Presentations'));
    renderSchedule(await fetchSheetData('Schedule'));
    renderThisWeek(await fetchSheetData('This Week in Psychiatry!'));
  })();
</script>
