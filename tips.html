<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tips och Inspiration</title>
  <style>
    body {
      font-family: system-ui, sans-serif;
      margin: 0;
      padding: 1rem;
      background: #f9f9f9;
      color: #222;
    }
    header {
      background-color: #003366;
      color: white;
      padding: 1rem;
      text-align: center;
    }
    h1 {
      font-size: 1.5rem;
      margin: 0;
    }
    .section {
      max-width: 800px;
      background: white;
      margin: 2rem auto;
      padding: 1.25rem;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    }
    h2 {
      border-bottom: 2px solid #ccc;
      padding-bottom: 0.3rem;
    }
    form label {
      display: block;
      margin-top: 1rem;
      font-weight: bold;
    }
    form input, form textarea {
      width: 100%;
      padding: 0.5rem;
      margin-top: 0.25rem;
      border: 1px solid #ccc;
      border-radius: 4px;
    }
    form button {
      margin-top: 1rem;
      padding: 0.5rem 1rem;
      background-color: #003366;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    form button:hover {
      background-color: #002244;
    }
    .entry {
      margin-top: 1rem;
      padding: 0.75rem;
      border: 1px solid #ddd;
      border-radius: 6px;
      background: #fefefe;
    }
    .entry a {
      color: #003366;
    }
  </style>
</head>
<body>
  <header>
    <h1>Tips och Inspiration</h1>
  </header>
  <section class="section">
    <p>Har du nyligen läst en översiktsartikel, en aktuell studie, en debattartikel eller hört ett avsnitt av en psykiatripodd som verkligen gjorde intryck? Eller kanske blivit inspirerad eller upplyst av en dokumentär, film eller tv-serie med psykiatrisk anknytning?</p>
    <p>Dela gärna dina tips här så kan de lyftas i Journal Club eller läggas till i inspirationssamlingen.</p>

    <form id="tipsForm">
      <label for="datum">Datum</label>
      <input type="date" id="datum" name="Datum">

      <label for="titel">Titel / Namn på resurs</label>
      <input type="text" id="titel" name="Titel" required>

      <label for="lank">Länk (om tillgänglig)</label>
      <input type="url" id="lank" name="Länk">

      <label for="kategori">Kategori (artikel, podd, bok, film etc.)</label>
      <input type="text" id="kategori" name="Kategori">

      <label for="kommentar">Varför är detta intressant eller inspirerande?</label>
      <textarea id="kommentar" name="Kommentar" rows="4"></textarea>

      <label for="namn">Förnamn (valfritt)</label>
      <input type="text" id="namn" name="Namn">

      <button type="submit">Skicka in</button>
    </form>

    <div id="tips-list">
      <h2 style="margin-top: 2rem;">Inkomna Tips</h2>
      <div id="tips-content">Laddar...</div>
    </div>

    <p style="margin-top: 2rem;"><a href="index.html">&larr; Tillbaka till startsidan</a></p>
  </section>

  <script>
    const scriptURL = 'https://script.google.com/macros/s/AKfycbzvg7NbHz7wFoXVoua4kpWXXjKaQK2GqPd4kyEjVztyc8j7LEgcXj9UlsYzBnc8s_H-Zg/exec';

    document.getElementById('tipsForm').addEventListener('submit', async function(event) {
      event.preventDefault();

      const form = event.target;
      const data = {
        Datum: form.datum.value,
        Titel: form.titel.value,
        Länk: form.lank.value,
        Kategori: form.kategori.value,
        Kommentar: form.kommentar.value,
        Namn: form.namn.value
      };

      try {
        const response = await fetch(scriptURL, {
          method: 'POST',
          body: JSON.stringify(data),
          headers: {
            'Content-Type': 'application/json'
          }
        });

        if (response.ok) {
          alert("Tack! Ditt tips har skickats in.");
          form.reset();
          loadTips();
        } else {
          alert("Något gick fel. Försök igen.");
        }
      } catch (error) {
        console.error('Error:', error);
        alert("Det gick inte att skicka in formuläret.");
      }
    });

    async function loadTips() {
      try {
        const res = await fetch(scriptURL + '?sheet=Tips%20och%20inspiration');
        const tips = await res.json();
        const container = document.getElementById('tips-content');
        container.innerHTML = tips.reverse().map(row => `
          <div class="entry">
            <strong>${row.Datum}</strong> — <em>${row.Kategori}</em><br>
            <a href="${row.Länk}" target="_blank">${row.Titel}</a><br>
            ${row.Kommentar}<br>
            <small>Tipsat av: ${row.Namn || 'Anonym'}</small>
          </div>
        `).join('');
      } catch (error) {
        console.error('Error loading tips:', error);
        document.getElementById('tips-content').textContent = 'Kunde inte hämta tips just nu.';
      }
    }

    loadTips();
  </script>
</body>
</html>
